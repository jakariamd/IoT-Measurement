Login with Amazon Getting Started Guide API Version 2013-01-03 Login with Amazon Getting Started Guide Login with Amazon: Getting Started Guide Copyright © 2013 Amazon Services, LLC or its affiliates. All rights reserved. The following are trademarks or registered trademarks of Amazon: Amazon, Amazon.com. In addition, Amazon.com graphics, logos, page headers, button icons, scripts, and service names are trademarks, or trade dress of Amazon in the U.S. and/or other countries. Amazon's trademarks and trade dress may not be used in connection with any product or service that is not Amazon's, in any manner that is likely to cause confusion among customers, or in any manner that disparages or discredits Amazon. All other trademarks not owned by Amazon are the property of their respective owners, who may or may not be affiliated with, connected to, or sponsored by Amazon. Login with Amazon Getting Started Guide Get Started with Login with Amazon ...................................................................................................... 1 Login with Amazon Features and Benefits ............................................................................................. 2 Features .................................................................................................................................................. 2 Benefits ................................................................................................................................................... 3 How Login with Amazon Works .............................................................................................................. 4 Login with Amazon Conceptual Overview .............................................................................................. 4 Choosing an Authorization Grant ............................................................................................................ 6 Sign Up for Login with Amazon .............................................................................................................. 8 Adding Login with Amazon to Your Website .......................................................................................... 11 Where Do I Go from Here? ................................................................................................................... 14 About This Guide .................................................................................................................................. 17 Glossary ............................................................................................................................................... 15 API Version 2013-01-03. Amazon Confidential. Login with Amazon Getting Started Guide How Do I...? Get Started with Login with Amazon This is the Login with Amazon Getting Started Guide. This guide allows web developers who have signed up use Login with Amazon through Seller Central to enable Login with Amazon on their websites quickly. More detailed information on how Login with Amazon works, including error handling and security considerations, can be found in the Login with Amazon Developer's Guide. Login with Amazon is a web service that enables Amazon customers to sign in to your website using their Amazon credentials and grant your site access to information from their Amazon profile. How Do I...? See the following table for links to information on how to work with Login with Amazon. How Do I... Relevant Resources Learn more about the business case for Login with Amazon Login with Amazon Features and Benefits Learn how Login with Amazon works How Login with Amazon Works Sign up for Login with Amazon Sign Up for Login with Amazon Try Login with Amazon for myself Adding Login with Amazon to Your Website Get answers to frequently asked questions Get help from the community of developers Login with Amazon Frequently Asked Questions Login with Amazon Discussion Forums API Version 2013-01-03. Amazon Confidential. Login with Amazon Getting Started Guide Features Login with Amazon Features and Benefits Features Login with Amazon offers several features that help you manage customer login. Trusted Login. Customers can choose to "Login with Amazon," using their Amazon credentials to gain access to your web site. Profile Information. Customers can choose to share information from their Amazon account with your web site, such as name and e-mail address. Over time, we'll add to the list of ways to interact with Amazon customers via Login with Amazon. Privacy Control. Login with Amazon handles the burden of managing customer consent, ensuring that information is only shared with the customer's explicit agreement. Standards-based Technology. Login with Amazon is based on OAuth 2.0, which has been broadly adopted for user-authorized exchanges across sites. This includes support for both Authorization Code and Implicit grant types. Javascript SDK Login with Amazon provides a Javascript SDK that enables developers to quickly and simply authorize users. API Version 2013-01-03. Amazon Confidential. Login with Amazon Getting Started Guide Benefits Benefits Login with Amazon enables Amazon customers to use their trusted Amazon account at participating web sites across the Internet. As a developer or web site owner, Login with Amazon offers you the following benefits: • Increased login rate and reduced abandonment, leading to increased satisfaction and retention for your customers. • Reduced infrastructure and operational costs, by outsourcing user authentication to Amazon. • Increased customer trust, by combining the strength of Amazons brand with yours. API Version 2013-01-03. Amazon Confidential. Login with Amazon Getting Started Guide Login with Amazon Conceptual Overview How Login with Amazon Works Login with Amazon Conceptual Overview All Login with Amazon applications use the same broad steps to allow a user to login and grant the website access to their customer profile data. API Version 2013-01-03. Amazon Confidential. Login with Amazon Getting Started Guide Login with Amazon Conceptual Overview Login with Amazon works by providing third-party websites with a recognizable login button that users click to login with their Amazon credentials. To login, users are presented with an amazon.com popup and asked to provide their Amazon password. For example: API Version 2013-01-03. Amazon Confidential. Login with Amazon Getting Started Guide Choosing an Authorization Grant If this is the first time users have logged in from this site, Amazon presents them with a list of access permissions requested by the website. Websites can request the name and email address of the user, and/or request the user's postal (zip) code. For example: After users log in, the client website will use an authorization grant to get an access token. The website can then use the access token to access a customer profile, specifying an access scope. Choosing an Authorization Grant The two mechanisms websites can use to obtain access tokens are the Implicit grant and the Authorization Code grant. Both authorization grants work by redirecting the user-agent (the user's browser) to Amazon.com for them to login. Once they have logged in, if the website requested an implicit grant, the access token is embedded as a fragment in a URI that redirects the user-agent back to the client website. The website then uses a script to obtain the data from the user-agent. If the website requests an authorization code, the user-agent is redirected back to the website and the authorization code is passed as a query string in that URI. The website then makes a secure HTTP call to Amazon behind the scenes to exchange the authorization code for an access token. Before you implement a Login with Amazon application, you must choose which authoriziation grant you will use. Which Grant Type is Right for Your Application? In general, the advantages of one authorization grant mirror the disadvantages of the other grant. API Version 2013-01-03. Amazon Confidential. Login with Amazon Getting Started Guide Choosing an Authorization Grant The advantage of the authorization code grant is that it is more secure than the implicit grant. The user is not involved in the request for the access token, as that takes place directly between the client website and the authorization service. The authorization code grant also features refresh tokens, which gives the client website almost indefinite access to the customer profile data. The disadvantage to the authorization code grant is that it is harder to implement, and relies on server-side scripting. The authorization code grant also uses more round trips than the implicit grant. The advantage of the implicit grant is that it is relatively simple to implement, as it relies on the web browser to receive and store the access token. In fact, if the client architecture does not support server-side scripting, this is the only authorization grant that will work with the Login with Amazon authorization service. The implicit grant also makes fewer round trips than the authorization code grant. The disadvantage of the implicit grant is that because the user's browser makes the access token request, the user is exposed to the access token. From a strict security perspective, it is better to conceal this information. Also, in the implicit grant, when an access token expires, the user must re-authenticate to continue accessing the resources. The authorization code grant features refresh tokens that can be used to obtain a new access token without involving the user. If you cannot use server-side scripting, the implicit grant is your only choice. If you can use server-side scripting, we recommend choosing the authorization code grant over the implicit grant. This guide contains a quick start using the Implicit grant through our Javascript SDK. For more information on the Authorization Code grant, see the Developer's Guide. API Version 2013-01-03. Amazon Confidential. Login with Amazon Getting Started Guide Sign Up for Login with Amazon The first step in using the Login with Amazon authorization service is to create a new Login with Amazon application on the Seller Central website. The Login with Amazon application contains business and technical information about your Login with Amazon account. The business information is displayed to Login with Amazon users when they are presented with login and consent forms. This includes the name of your business, your logo, and a link to your privacy policy. The technical information is used by Login with Amazon to ensure that incoming requests are returning to a pre-approved URL. This is a security feature to prevent attackers from imitating a valid request but capturing the return values on their own site. In this section, we show you how to create an Login with Amazon application. By the end of this section, you will have: • A registration with Login with Amazon. • A shared secret value that you will use when calling the Login with Amazon authorization service. Creating a Login with Amazon Application To create an Login with Amazon application, you must have a Seller Central account, and have added Login with Amazon to your account. For more information on how to do that, visit https://sellercentral.amazon.com. 1. On the Seller Central main screen, you will see a Create New Application button in the center of the page if you have not created an Login with Amazon application before. Otherwise, this button will appear on the right side of the page. Click the button to being creating a new Login with Amazon application. API Version 2013-01-03. Amazon Confidential. Login with Amazon Getting Started Guide 2. On the Create Login with Amazon Application screen, enter the following the business information: a. Enter an Application Display Name. This name will be displayed on the consent screen when a user is asked to give your application permission to access their profile. It also appears on the list of active Login with Amazon websites in the Your Account section for Amazon users. b. Enter a Privacy Notice URL. This is a link that users can click to access your Privacy Notice (or Privacy Policy). It is also displayed on the consent screen. This URL must start with http:// or https:// c. Upload a Logo Image File. This logo is displayed on the consent screen to represent your business or website. The logo will be displayed as a 150x150 pixel image; if you upload a file of a different size it will be scaled to fit. 3. On the same screen, enter the Website Redirect URLs for your application. When a user clicks the Login with Amazon button on your website, they will be directed to Amazon.com. That request will include a Redirect URL to direct the user back to your website when they have logged in. If the Redirect URL on the request does not match one of the Redirect URLs registered with your application, the request will fail. Redirect URLs must start with https://. You will be able to update this information later if you choose (for example, to add redirect URLs). 4. Once you have entered the information, click Save to save the application. Once you have created an Login with Amazon application, you will be assigned a client identifier and a client secret. One or both of these values are used when your website calls Login with Amazon to get user consent or access user data. (The Implicit grant only requires the client identifier). To view or edit these values, edit your Login with Amazon application. Editing your Login with Amazon application Once you have created an Login with Amazon application, you can change the settings at any time through Seller Central by clicking the View/Edit settings button. API Version 2013-01-03. Amazon Confidential. Login with Amazon Getting Started Guide 1. From the Seller Central main screen, select your Login with Amazon application and choose View/Edit application settings. The View/Edit Application popup appears, allowing you to change values you previously entered, as well as view and reset your client identifier and client secret. 2. To change your business or technical information, edit the information and click the Save button. 3. To view your client secret, click Show under Client Secret. API Version 2013-01-03. Amazon Confidential. Login with Amazon Getting Started Guide Add a Login with Amazon Button Adding Login with Amazon to Your Website Topics • Add a Login with Amazon Button (p. 11) • Enable the User to Sign In (p. 12) These steps will allow you to quickly integrate Login with Amazon with your website using the Implicit grant. If you have not yet registered your website with Login with Amazon, follow the steps listed in Sign Up for Login with Amazon first. Add a Login with Amazon Button On your website, add a login button from the set of Amazon-provided Login with Amazon buttons. These buttons are provided in different sizes and styles and hosted by Amazon. See Button Image Guidance for a list of buttons and their URLs. To get started immediately, try the following: <button id="LoginWithAmazon"> <img border="0" href="#" alt="Login with Amazon" src="http://g-ecx.images-amazon.com/images/G/01/iba/assets/images/Login WithAmazon_Gold_M.jpg" width="137" height="24"></button> If you would prefer to use HTTPS, use this: <button id="LoginWithAmazon"> <img border="0" href="#" alt="Login with Amazon" src="https://images-na.ssl-images-amazon.com/images/G/01/iba/assets/images/Lo ginWithAmazon_Gold_M.jpg" width="137" height="24"></button> Later, the script we use to login will lookup this button using the LoginWithAmazon identifier. API Version 2013-01-03. Amazon Confidential. Login with Amazon Getting Started Guide Enable the User to Sign In Enable the User to Sign In Now you need to make the Login with Amazon button clickable, and use the Javascript SDK to call the Login with Amazon authorization service when the user clicks the button. That takes a few simple steps: To Call the Authorization Service Load the Javascript SDK Before you can make an access grant call or retrieve a profile using the Javascript SDK, it must load itself from Amazon's content delivery network. To load the SDK, use the following code: <div id="amazon-root"></div> <script type="text/javascript"> window.onAmazonLoginReady = function() { amazon.Login.setClientId('YOUR-CLIENT-ID'); (function(d) { var a = d.createElement('script'); a.type = 'text/javascript'; a.async = true; a.id = 'amazon-login-sdk'; a.src = 'https://api-cdn.amazon.com/sdk/login1.js'; d.getElementById('amazon-root').appendChild(a); })(document); </script> Place the code as soon after the <body> tag as possible. The SDK will load asynchronously and should not slow down the rest of the page. Once the SDK has loaded, it will call window.onAmazonLoginReady for initialization. 2. Add your client identifier to the SDK, in the amazon.Login.setClientId call, by replacing YOUR-CLIENT-ID with your client identifier. If you do not know your client identifer, see Sign Up for Login with Amazon. 3. Add the following Javascript to your button handler, below your button definition: <script type="text/javascript"> document.getElementById('LoginWithAmazon').onclick = function() { setTimeout(window.doLogin, 1); return false; window.doLogin = function() { options = {}; options.scope = 'profile'; amazon.Login.authorize(options, function(response) { if ( response.error ) { alert('oauth error ' + response.error); return; amazon.Login.retrieveProfile(response.access_token, function(response) alert('Hello, ' + response.profile.Name); alert('Your e-mail address is ' + response.profile.PrimaryEmail); alert('Your unique ID is ' + response.profile.CustomerId); if ( window.console && window.console.log ) API Version 2013-01-03. Amazon Confidential. Login with Amazon Getting Started Guide Enable the User to Sign In window.console.log(response); }); }); </script> This code will use the SDK to present a login popup and handle the response. getElementById must reference the same identifier as the one you used for your button (in our example, LoginWithAmazon). If you use a different identifer, make sure to update the value in the script to match. 4. You are now ready to test the button your website. API Version 2013-01-03. Amazon Confidential. Login with Amazon Getting Started Guide Next Steps Where Do I Go from Here? Topics • Next Steps (p. 14) Login with Amazon offers features we haven't covered in this guide, such as the Authorization Code grant. This section provides links to additional resources, which will help you deepen your understanding and use of Login with Amazon;. Next Steps Handling non-Javascript Users If you want to allow users to login who do not have JavaScript enabled in their browsers, you can add a fallback URL to your buttons and handle the response from the authorization service manually. Steps TBD. Code Directly to the Web Service API If you want to write code directly to the Login with Amazon endpoint, go to the Login with Amazon Developer's Guide. The guide describes how to use all the features of Login with Amazon, including the Authorization Code grant. Learn about Login with Amazon Security Visit the Login with Amazon Developer's Guide Security Considerations chapter to learn about Login with Amazon security, including how to rotate your client identifier and how to prevent Cross-Site Request Forgery. API Version 2013-01-03. Amazon Confidential. Login with Amazon Getting Started Guide Glossary access scope access token application An access scope defines the type of user profile data the client is requesting. The first time a user logs in, they see a list of the items in the access scope and must agree to provide the data to the client in order to proceed. An access token is granted by the authorization server when a user logs in to a site. An access token is specific to a client, a user, and an access scope. A client must use an access token to retrieve customer profile data. An application contains information the authorization service needs for a client website in order to allow that website access to customer profiles. authorization code An authorization code is a value used by the Authorization Code grant to allow a website to request an access token. Authorization Code grant authorization grant authorization service client client secret An Authorization Code grant is an authorization grant that uses server-based processing to request an access token. Using the authorization code grant, the server receives an authorization code as a query parameter after the user logs in. The server exchanges the authorization code, client identifier, and client secret for an access token and a refresh token. A authorization grant is the process where the authorization service verifies a client website's request for access to a customer profile. An authorization grant requires a client identifier and an access scope, and may require a client secret. If the process succeeds, the website is granted an access token. There are two types of authorization grants, an Implicit grant and an Authorization Code grant. The Login with Amazon authorization service is the collection of endpoints provided by Amazon that allows a client to login a user through authorization grant. The authorization service presents the login screen and the permissions screen to users. It provides access token, refresh token, and customer profile data to Login with Amazon clients. A client is a website that uses Login with Amazon. The client secret, like the client identifier, is a value assigned to the client when they register with Login with Amazon. It is used in conjunction with the client identifier to verify the identity of the client when they request an authorization grant from the authorization service. The client secret must be kept confidential. client identifier The client identifier is a value assigned to the client when they register with IBA. It is used in conjunction with the client secret to verify the identity of the client API Version 2013-01-03. Amazon Confidential. Login with Amazon Getting Started Guide when they request an authorization grant from the authorization service. The client identifier is not secret. A customer profile contains information about the Login with Amazon customer, including their name, email address, postal code, and a unique identifier. A website must obtain an access token before they can obtain a customer profile. The kind of profile data returned is determined by the access scope. An Implicit grant is an authorization grant that can be completed using only the user's web browser. Using the implicit grant, the browser receives an access token as a URI fragment. An implicit grant requires a client identifier and an access scope. The implicit grant does not return a refresh token. A PNG file provided by the client when setting up an application. This is displayed on the permissions screen if the user has not granted access to the client website. The logo represents the client website. A URL provided by the client when setting up an application. This is displayed on the permissions screen if the user has not granted access to the client website. The URL should direct users to the privacy policy for the client website. A URL provided by the client to the authorization service. After the user logs in, the service will redirect the user's browser to this address. A refresh token is granted by the authorization server when the client uses the authorization code grant. A client can use a refresh token to request a new access token when the current access token expires. A user is a person who visits a client website and tries to log in using Login with Amazon. customer profile Implicit grant logo image file privacy notice URL redirect URL refresh token user API Version 2013-01-03. Amazon Confidential. Login with Amazon Getting Started Guide About This Guide This is the Login with Amazon Getting Started Guide. It was last updated on February 15, 2013. API Version 2013-01-03. Amazon Confidential.